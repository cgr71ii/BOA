<?xml version="1.0" encoding="UTF-8"?>

<boa_rules>
    <parser>
        <name>pycparser</name>
        <lang_objective>C</lang_objective>
        <module_name>boapm_pycparser</module_name>
        <class_name>BOAPMPycparser</class_name>
        <callback>
            <method name="ast" callback="get_ast" />
        </callback>
        <env_vars>
            <env_var>PYCPARSER_FAKE_LIBC_INCLUDE_PATH</env_var>
        </env_vars>
    </parser>
    <modules>
        <module>
            <module_name>boam_cfg</module_name>
            <class_name>BOAModuleControlFlowGraph</class_name>
            <lifecycle_handler>boalc_pycparser_ast.BOALCPycparserAST</lifecycle_handler>
            <args>
                <!-- Check the CFG rules file in order to know which args accepts -->
                <dict>
                    <!-- It makes easier to apply Taint Analysis to a single function
                            if there are not references to other functions -->
                    <element name="propagate_func_call" value="false" />
                </dict>
            </args>
        </module>
        <module>
            <module_name>boam_taint_analysis</module_name>
            <class_name>BOAModuleTaintAnalysis</class_name>
            <!--<lifecycle_handler>boalc_pycparser_ast.BOALCPycparserAST</lifecycle_handler>-->
            <args>
                <dict>
                    <list name="sources">
                        <!-- Check the Source class documentation in order to know what a Source
                             means in Taint Analysis terminology -->
                        <!--
                            format: name@type@function
                            **************************
                            name: name of the object which is a Source
                            type: type of the Source (check for allowed types in the TA module)
                            function (optional): function which contains the Source (if
                                                 specified, other functions will not be
                                                 affected unless you specify other rules)
                        -->
                        <element value="argc@variable@main" />
                        <element value="argv@variable@main" />
                        <element value="gets@function" />
                    </list>
                    <list name="sinks">
                        <!-- Check the Sink class documentation in order to know what a Sink
                             means in Taint Analysis terminology -->
                        <!--
                            format: function_name@dangerous_parameter
                            *****************************************
                            function_name: name of the function which is a Sink
                            dangerous_parameter: position of the dangerous parameter
                                of the Sink (0 for all parameters or None if has no
                                parameters). The value '1' means first parameter.
                        -->
                        <element value="strcpy@1" />
                        <element value="system@0" />
                        <!-- <element value="system@1" />  would have the same effect because
                                                           system() only accepts 1 parameter -->
                        <element value="strncpy@2" />
                    </list>
                </dict>
            </args>
            <dependencies>
                <dependency>
                    <!-- We need the CFG in order to execute the Taint Analysis module -->

                    <module_name>boam_cfg</module_name> 
                    <class_name>BOAModuleControlFlowGraph</class_name>
                    <callback> 
                        <method name="cfg" callback="get_basic_cfg" />
                    </callback>
                </dependency>
            </dependencies>
        </module>
    </modules>
    <report>
        <args>
            <!-- Empty -->
        </args>
    </report>
</boa_rules>